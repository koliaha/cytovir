(()=>{"use strict";class t extends class{constructor(t){this.element=t}get left(){return this.element.offsetLeft}get right(){return this.element.offsetLeft+this.element.offsetWidth}get top(){return this.element.offsetTop}get bottom(){return this.element.offsetTop+this.element.clientHeight}set left(t){this.element.style.left=t+"px"}set top(t){this.element.style.top=t+"px"}get width(){return this.element.offsetWidth}get heigth(){return this.element.clientHeight}}{constructor(t){super(new Image(t.width,t.width)),this.delay=t.delay,this.target=t.target,this.startPos=[t.left,t.top],this.speed=t.speed,this.element.src="./assets/virus.svg",this.radius=t.width/2,this.setupPos(t)}backToStartPos(){this.element.style.left=this.startPos[0],this.element.style.top=this.startPos[1],setTimeout((()=>{this.start()}),500*this.speed)}setupPos(t){this.element.style.left=this.startPos[0],this.element.style.top=this.startPos[1],this.element.classList.add("virus"),this.element.style.transition=`all ${this.speed}s ease`,document.getElementById("virus-container").appendChild(this.element)}start(){this.left=this.target[0]-this.radius,this.top=this.target[1]-this.radius}get x(){return this.left+this.radius}get y(){return this.top+this.radius}}class e{constructor(){this.element=document.getElementById("active-zone"),this.rect=this.element.getBoundingClientRect(),this.radius=this.rect.width/2,this.maxOffset=16,this.isInActiveZone=!0,this.stop,this.restart}start(){window.addEventListener("deviceorientation",this.handleOrientation.bind(this),!0)}handleOrientation(t){let e=t.beta,s=t.gamma;Math.abs(e)>this.maxOffset||Math.abs(s)>this.maxOffset?this.isInActiveZone&&(this.isInActiveZone=!1,this.stop()):this.isInActiveZone||(this.isInActiveZone=!0,this.restart()),this.x=2*s,this.y=2*e}get x(){return this.left+this.radius}get y(){return this.top+this.radius}get top(){return this.element.getBoundingClientRect().top}get left(){return this.element.getBoundingClientRect().left}set x(t){this.element.style.left=t+"px"}set y(t){this.element.style.top=t+"px"}}class s{constructor(){this.progressBar=document.getElementById("progress-bar"),this.timerSpan=document.getElementById("timer"),this.wrapper=document.getElementById("time-controll"),this.timer,this.onWin}startTimer(){this.progressBar.classList.remove("hidden");let t=5;this.timer=setInterval((()=>{t-=1,0===t&&(clearInterval(this.timer),this.onWin()),this.timerSpan.innerText=`0${t}`}),1e3)}restart(){this.startTimer()}stop(){this.progressBar.classList.add("hidden"),clearInterval(this.timer),this.timerSpan.innerText="05"}}const i=document.getElementById("frame-1"),n=document.getElementById("packshot"),r=document.getElementById("modal"),a="hidden",h=40,l={gamma:null,delta:null,beta:null,isStart:!1};let o=!1;function d(){o||(o=!0,window.removeEventListener("deviceorientation",d),window.removeEventListener("click",d),r.classList.add(a),m.startGame())}const m=new class{constructor(i){this.area=new e,this.timer=new s;let n=document.getElementById("wrapper"),r=[n.offsetLeft,n.offsetTop+n.offsetWidth/2];this.viruses=[new t({top:"12%",left:"8%",width:80,speed:3,target:r,delay:0}),new t({top:"8%",left:"80%",width:95,speed:4,target:r,delay:1e3}),new t({top:"70%",left:"2%",width:160,speed:5,target:r,delay:500}),new t({top:"70%",left:"90%",width:110,speed:3,target:r,delay:10}),new t({top:"40%",left:"-20%",width:90,speed:3,target:r,delay:10}),new t({top:"45%",left:"120%",width:85,speed:4,target:r,delay:200})],this.area.restart=()=>this.timer.restart(),this.area.stop=()=>this.timer.stop(),this.timer.onWin=i}circleIntersect(t,e,s,i,n,r){return(t-i)*(t-i)+(e-n)*(e-n)<=(s+r)*(s+r)}startGame(){this.timer.startTimer(),this.area.start(),this.viruses.forEach((t=>{setTimeout((()=>{t.start()}),t.delay)})),setInterval((()=>{this.viruses.forEach((t=>{let e=this.area;this.circleIntersect(t.x,t.y,t.radius,e.x,e.y,e.radius)&&t.backToStartPos()}))}))}}((function(){i.classList.add(a),n.classList.remove(a)}));n.addEventListener("click",(()=>{const t=getUrlParameter("url");window.open(t,"_blank"),myclick()})),window.addEventListener("deviceorientation",(function(t){l.isStart?(l.gamma+t.gamma>h&&l.beta+t.beta>h||l.beta+t.beta>h&&l.delta+t.delta>h||l.delta+t.delta>h&&l.gamma+t.gamma>h)&&d():(l.gamma=t.gamma,l.beta=t.beta,l.delta=t.delta,l.isStart=!0)})),window.addEventListener("click",d);let c=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${c}px`),window.addEventListener("resize",(()=>{let t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${t}px`)}))})();